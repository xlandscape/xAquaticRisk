<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Harrell-Davis Distribution-Free Quantile Estimator</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for hdquantile {Hmisc}"><tr><td>hdquantile {Hmisc}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Harrell-Davis Distribution-Free Quantile Estimator</h2>

<h3>Description</h3>

<p>Computes the Harrell-Davis (1982) quantile estimator and jacknife
standard errors of quantiles.  The quantile estimator is a weighted
linear combination or order statistics in which the order statistics
used in traditional nonparametric quantile estimators are given the
greatest weight.  In small samples the H-D estimator is more efficient
than traditional ones, and the two methods are asymptotically
equivalent.  The H-D estimator is the limit of a bootstrap average as
the number of bootstrap resamples becomes infinitely large.
</p>


<h3>Usage</h3>

<pre>
hdquantile(x, probs = seq(0, 1, 0.25),
           se = FALSE, na.rm = FALSE, names = TRUE, weights=FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr valign="top"><td><code>probs</code></td>
<td>
<p>vector of quantiles to compute</p>
</td></tr>
<tr valign="top"><td><code>se</code></td>
<td>
<p>set to <code>TRUE</code> to also compute standard errors</p>
</td></tr>
<tr valign="top"><td><code>na.rm</code></td>
<td>
<p>set to <code>TRUE</code> to remove <code>NA</code>s from <code>x</code>
before computing quantiles</p>
</td></tr>
<tr valign="top"><td><code>names</code></td>
<td>
<p>set to <code>FALSE</code> to prevent names attributions from
being added to quantiles and standard errors</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>set to <code>TRUE</code> to return a <code>"weights"</code>
attribution with the matrix of weights used in the H-D estimator
corresponding to order statistics, with columns corresponding to
quantiles.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Fortran routine is used to compute the jackknife leave-out-one
quantile estimates.  Standard errors are not computed for quantiles 0 or
1 (<code>NA</code>s are returned).
</p>


<h3>Value</h3>

<p>A vector of quantiles.  If <code>se=TRUE</code> this vector will have an
attribute <code>se</code> added to it, containing the standard errors.  If
<code>weights=TRUE</code>, also has a <code>"weights"</code> attribute which is a matrix.
</p>


<h3>Author(s)</h3>

<p>Frank Harrell</p>


<h3>References</h3>

<p>Harrell FE, Davis CE (1982): A new distribution-free quantile
estimator.  Biometrika 69:635-640.
</p>
<p>Hutson AD, Ernst MD (2000): The exact bootstrap mean and variance of
an L-estimator.  J Roy Statist Soc B 62:89-94.
</p>


<h3>See Also</h3>

<p><code><a href="../../stats/html/quantile.html">quantile</a></code></p>


<h3>Examples</h3>

<pre>
set.seed(1)
x &lt;- runif(100)
hdquantile(x, (1:3)/4, se=TRUE)

## Not run: 
# Compare jackknife standard errors with those from the bootstrap
library(boot)
boot(x, function(x,i) hdquantile(x[i], probs=(1:3)/4), R=400)

## End(Not run)
</pre>

<hr /><div style="text-align: center;">[Package <em>Hmisc</em> version 4.8-0 <a href="00Index.html">Index</a>]</div>
</div></body></html>
