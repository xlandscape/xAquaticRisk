<?xml version="1.0" encoding="utf-8"?>
<MCRun>
    <Observers>
        <Observer module="observer" class="ConsoleObserver">
            <show_messages_get_values_ok>$(VerboseLogging)</show_messages_get_values_ok>
        </Observer>
        <Observer module="observer" class="GraphMLObserver">
            <Output_File>$(_MCS_BASE_DIR_)\$(_MC_NAME_)\composition.graphml</Output_File>
            <Include_Modules>true</Include_Modules>
        </Observer>
        <Observer module="observer" class="LogFileObserver">
            <LogFile>$(_EXP_BASE_DIR_)\$(SimID)\log\mc_$(_MC_NAME_).log</LogFile>
            <show_messages_get_values_ok>$(VerboseLogging)</show_messages_get_values_ok>
        </Observer>
    </Observers>
    <Store module="stores" class="X3dfStore">
        <File_Path>$(_MCS_BASE_DIR_)\$(_MC_NAME_)\store</File_Path>
        <Observer>
            <ObserverReference/>
        </Observer>
        <Initialization>$(ParentRun)</Initialization>
        <Identifier>$(_MC_ID_)</Identifier>
    </Store>
    <Global>
        <Temp0>20</Temp0>
        <Q10>2.2</Q10>
        <PlantUptake>0</PlantUptake>
        <QFac>-9999</QFac>
        <LGUTS_BackgroundHazardRate>0</LGUTS_BackgroundHazardRate>
        <UseSubLethalToxEffects>False</UseSubLethalToxEffects>
        <ThresholdPopulationSizeForSuperIndividuals>10</ThresholdPopulationSizeForSuperIndividuals>
        <NumberOfSiblingsPerSuperIndividual>70</NumberOfSiblingsPerSuperIndividual>
        <InitialBiomassForMacroinvertebrates>1</InitialBiomassForMacroinvertebrates>
        <InitialBiomassForFish>0.1</InitialBiomassForFish>
        <MaximumPeriphytonGrowthRate>.5</MaximumPeriphytonGrowthRate>
        <PeriphytonCarryingCapacity>.3</PeriphytonCarryingCapacity>
        <PeriphytonArrheniusTemperature>5500</PeriphytonArrheniusTemperature>
        <InitialLeafLitterDensity>2</InitialLeafLitterDensity>
        <LeafLitterEnergyDensity>2700</LeafLitterEnergyDensity>
        <DayOfYearForLitterAddition>270</DayOfYearForLitterAddition>
        <C-PomSettlementRate>0.1</C-PomSettlementRate>
        <MaximumVelocityClassForC-PomAddition>3</MaximumVelocityClassForC-PomAddition>
        <SettlementRateForFPomAndAnimalRemains>0</SettlementRateForFPomAndAnimalRemains>
        <InitialF-PomDensity>500</InitialF-PomDensity>
        <InitialS-PomDensity>500</InitialS-PomDensity>
        <FractionOfS-PomAvailableToFilterFeeders>0.0001</FractionOfS-PomAvailableToFilterFeeders>
        <PeriphytonEnergyDensity>4623</PeriphytonEnergyDensity>
        <UsePopulationDensity>TRUE</UsePopulationDensity>
        <SavePopulationSize>TRUE</SavePopulationSize>
        <SaveTraitSize>False</SaveTraitSize>
        <SavePopulationDistribution>False</SavePopulationDistribution>
        <SaveTraitDistribution>False</SaveTraitDistribution>
        <MultiplicationFactors>
            0.0009765625 0.001953125 0.00390625 0.0078125 0.015625 0.03125 0.0625 0.125 0.25 0.5
            1 2 4 8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768
        </MultiplicationFactors>
        <NumberLPopRuns>3</NumberLPopRuns>
        <NumberStreamComRuns>3</NumberStreamComRuns>
        <StreamComStartBiomass>Ind/m^2</StreamComStartBiomass>
        <RunCmfContinuous>false</RunCmfContinuous>
        <RunLPop>false</RunLPop>
        <RunStreamCom>false</RunStreamCom>
        <MultiplicationFactors_LPop>0 1 10</MultiplicationFactors_LPop>
        <StreamComReach1>567</StreamComReach1>
        <StreamComReach2>570</StreamComReach2>
        <StreamComReach3>580</StreamComReach3>
        <StreamComReach4>584</StreamComReach4>
        <UseEmpiricalWaterTemperatures>true</UseEmpiricalWaterTemperatures>
        <SaveEnvironmentalConditions>TRUE</SaveEnvironmentalConditions>
        <MinimumPeriphytonDensity>1</MinimumPeriphytonDensity>
        <ReproductionSuccessRate>2</ReproductionSuccessRate>
        <LeafLitterEntryDensity>9</LeafLitterEntryDensity>
    </Global>
    <Composition>
        <LandscapeScenario module="components" class="LandscapeScenario">
            <BaseLandscapeGeometries scales="global">$(:LandscapeScenario)</BaseLandscapeGeometries>
            <GeoPackageNamespace scales="global">urn:xAquaticRiskLandscapeScenarioPackageInfo</GeoPackageNamespace>
        </LandscapeScenario>
        <Weather module="components" class="MarsWeather">
            <FilePath scales="global">$(:Temperature)</FilePath>
        </Weather>
        <WaterTemperature
            module="components"
            class="WaterTemperatureFromAirTemperature"
            enabled="$(UseEmpiricalWaterTemperatures)"
        >
            <AirTemperature>
                <FromOutput component="Weather" output="TEMPERATURE_AVG"/>
            </AirTemperature>
        </WaterTemperature>
        <Hydrology module="components" class="HydrologyFromTimeSeries">
            <TimeSeries scales="global">$(:Hydrology)</TimeSeries>
            <FromTime type="date" scales="global">$(SimulationStart)</FromTime>
            <ToTime type="date" scales="global">$(SimulationEnd)</ToTime>
            <InflowTimeSeriesPath scales="global">$(:TimeSeries)</InflowTimeSeriesPath>
            <ImportInflows type="bool" scales="global">$(RunCmfContinuous)</ImportInflows>
            <Hydrography>
                <FromOutput component="LandscapeScenario" output="hydrography_geom"/>
            </Hydrography>
        </Hydrology>
        <PPM module="components" class="PpmCalendar">
            <SimulationStart type="date" scales="global">$(SimulationStart)</SimulationStart>
            <SimulationEnd type="date" scales="global">$(SimulationEnd)</SimulationEnd>
            <ApplicationWindows scales="global">$(ApplicationTimeWindow)</ApplicationWindows>
            <Fields>
                <FromOutput component="LandscapeScenario" output="FeatureIds"/>
            </Fields>
            <LandUseLandCoverTypes>
                <FromOutput component="LandscapeScenario" output="FeatureTypeIds"/>
            </LandUseLandCoverTypes>
            <TargetLandUseLandCoverType>
                <FromOutput component="LandscapeScenario" output="target_type"/>
            </TargetLandUseLandCoverType>
            <ApplicationRate type="float" unit="g/ha" scales="global">$(ApplicationRate)</ApplicationRate>
            <TechnologyDriftReduction type="float" unit="1" scales="global">
                $(TechnologyDriftReduction)
            </TechnologyDriftReduction>
            <InCropBuffer type="float" unit="m" scales="global">$(InCropBuffer)</InCropBuffer>
            <InFieldMargin type="float" unit="m" scales="global">0</InFieldMargin>
            <FieldGeometries type="list[bytes]">
                <FromOutput component="LandscapeScenario" output="Geometries"/>
            </FieldGeometries>
            <MinimumAppliedArea type="float" unit="m²" scales="global">10</MinimumAppliedArea>
            <RandomSeed type="int" scales="global">0</RandomSeed>
            <ProbabilityFieldApplied type="float" unit="1" scales="global">1</ProbabilityFieldApplied>
        </PPM>
    
        <!--
        <exploregeometries module="landscapepearl" class="ExploreGeometries">
            <FieldGeometries type="list[bytes]">
                <FromOutput component="LandscapeScenario" output="Geometries"/>
            </FieldGeometries>
            <HydrographyGeometries>
                <FromOutput component="LandscapeScenario" output="hydrography_geom"/>
            </HydrographyGeometries>
        </exploregeometries>
        -->
        
        <xDrainageRoutingMatrix module="landscapepearl" class="xDrainageRoutingTable">
            <FilePath scales="global">$(:xDrainageRouting)</FilePath>
            <FieldGeometries type="list[bytes]">
                <FromOutput component="LandscapeScenario" output="Geometries"/>
            </FieldGeometries>
            <HydrographyGeometries>
                <FromOutput component="LandscapeScenario" output="hydrography_geom"/>
            </HydrographyGeometries>
        </xDrainageRoutingMatrix>

        <landscapePEARL_interface module="landscapepearl" class="LandscapePEARL_interface">
            <ProcessingPath scales="global">$(_MCS_BASE_DIR_)\$(_MC_NAME_)\processing\pearl</ProcessingPath>
            <LPInputsPath scales="global">$(_MODEL_DIR_)\variant\landscapepearl</LPInputsPath>

            <RoutingMatrix type="list[bytes]">
                <FromOutput component="xDrainageRoutingMatrix" output="xDrainageRouting"/>
            </RoutingMatrix>   
            <WaterDischarge>
                <FromOutput component="Hydrology" output="Flow"/>
            </WaterDischarge>
        </landscapePEARL_interface>
       
        <xDrainageRouting_Wraper module="xdrainagerouting" class="xDrainageRouting_Wraper">
            <ProcessingPath scales="global">$(_MCS_BASE_DIR_)\$(_MC_NAME_)\processing\pearl</ProcessingPath>
            <RoutingMatrix type="list[bytes]">
                <FromOutput component="xDrainageRoutingMatrix" output="xDrainageRouting"/>
            </RoutingMatrix>
            <MasDraWatLay type="list[bytes]">
                <FromOutput component="landscapePEARL_interface" output="MasDraWatLay"/>
            </MasDraWatLay> 
            <FieldGeometries type="list[bytes]">
                <FromOutput component="LandscapeScenario" output="Geometries"/>
            </FieldGeometries>
            <HydrographyGeometries>
                <FromOutput component="LandscapeScenario" output="hydrography_geom"/>
            </HydrographyGeometries>
        </xDrainageRouting_Wraper>
        
        <SprayDrift  module="XSprayDrift" class="SprayDrift">
            <ProcessingPath scales="global">$(_MCS_BASE_DIR_)\$(_MC_NAME_)\processing\sd</ProcessingPath>
            <SimulationStart type="date" scales="global">$(SimulationStart)</SimulationStart>
            <SimulationEnd type="date" scales="global">$(SimulationEnd)</SimulationEnd>
            <Geometries>
                <FromOutput component="LandscapeScenario" output="Geometries"/>
            </Geometries>
            <GeometryCrs>
                <FromOutput component="LandscapeScenario" output="Crs"/>
            </GeometryCrs>
            <Extent>
                <FromOutput component="LandscapeScenario" output="Extent"/>
            </Extent>
            <HabitatTypes>
                <FromOutput component="LandscapeScenario" output="habitat_types"/>
            </HabitatTypes>
            <FieldDistanceSD type="float" unit="m" scales="global">0</FieldDistanceSD>
            <EPDistanceSD type="float" unit="m" scales="global">0</EPDistanceSD>
            <ReportingThreshold type="float" unit="g/ha" scales="global">0</ReportingThreshold>
            <ApplySimpleDriftFiltering type="bool" scales="global">false</ApplySimpleDriftFiltering>
            <LandUseLandCoverTypes>
                <FromOutput component="LandscapeScenario" output="FeatureTypeIds"/>
            </LandUseLandCoverTypes>
            <WindDirection type="int" unit="deg" scales="global">-1</WindDirection>
            <SprayDriftModel scales="global">XSprayDrift</SprayDriftModel>
            <SourceExposure unit="g/ha" scales="global">NA</SourceExposure>
            <RautmannClass scales="global">orchards.$(CropStage)</RautmannClass>
            <AppliedFields>
                <FromOutput component="PPM" output="AppliedFields"/>
            </AppliedFields>
            <ApplicationDates>
                <FromOutput component="PPM" output="ApplicationDates"/>
            </ApplicationDates>
            <ApplicationRates>
                <FromOutput component="PPM" output="ApplicationRates"/>
            </ApplicationRates>
            <TechnologyDriftReductions>
                <FromOutput component="PPM" output="TechnologyDriftReductions"/>
            </TechnologyDriftReductions>
            <AppliedAreas>
                <FromOutput component="PPM" output="AppliedAreas"/>
            </AppliedAreas>
            <SpatialOutputScale scales="global">base_geometry</SpatialOutputScale>
            <RandomSeed type="int" scales="global">0</RandomSeed>
            <MinimumDistanceToField type="float" unit="m" scales="global">0</MinimumDistanceToField>
            <FilteringTypes type="list[int]" scales="global">-1</FilteringTypes>
            <FilteringMinWidth type="float" unit="m" scales="global">999</FilteringMinWidth>
            <FilteringFraction type="float" unit="1" scales="global">0</FilteringFraction>
            <AgDriftBoomHeight scales="global">low</AgDriftBoomHeight>
            <AgDriftDropletSize scales="global">fine</AgDriftDropletSize>
            <AgDriftQuantile type="float" unit="1" scales="global">.9</AgDriftQuantile>
        </SprayDrift>
        <DepositionToReach module="components" class="DepositionToReach">
            <Deposition>
                <FromOutput component="SprayDrift" output="Exposure"/>
            </Deposition>
            <Reaches>
                <FromOutput component="Hydrology" output="Reaches"/>
            </Reaches>
            <Mapping>
                <FromOutput component="LandscapeScenario" output="reach_id"/>
            </Mapping>
            <SprayDriftCoverage>
                <FromOutput component="LandscapeScenario" output="hydrography_spray_drift_coverage"/>
            </SprayDriftCoverage>
            <DepositionInputSource scales="global" eval="true">
                'DepositionInputFile' if '$(DepositionInputFile)' else 'DepositionInput'
            </DepositionInputSource>
            <DepositionInputFile scales="global">$(_PARAM_DIR_)/$(DepositionInputFile)</DepositionInputFile>
        </DepositionToReach> 

        <CascadeToxswa module="cascade_toxswa" class="CascadeToxswa" enabled="$(RunCascadeToxswa)">
            <ProcessingPath scales="global">$(_MCS_BASE_DIR_)\$(_MC_NAME_)\processing\fate\cascade</ProcessingPath>
            <SuspendedSolids type="float" unit="g/m³" scales="global">15</SuspendedSolids>
            <TimeSeriesStart>
                <FromOutput component="Hydrology" output="TimeSeriesStart"/>
            </TimeSeriesStart>
            <LineicMassLoadingDrainage>
                <FromOutput component="xDrainageRouting_Wraper" output="LineicMassLoadingDrainage"/>
            </LineicMassLoadingDrainage>
            <WaterDischarge>
                <FromOutput component="Hydrology" output="Flow"/>
            </WaterDischarge>
            <WaterDepth>
                <FromOutput component="Hydrology" output="Depth"/>
            </WaterDepth>
            <Temperature>
                <FromOutput component="Weather" output="TEMPERATURE_AVG"/>
            </Temperature>
            <MassLoadingSprayDrift>
                <FromOutput component="DepositionToReach" output="Deposition"/>
            </MassLoadingSprayDrift>
            <MolarMass type="float" unit="g/mol" scales="global">$(MolarMass)</MolarMass>
            <SaturatedVapourPressure type="float" unit="Pa" scales="global">
                $(SaturatedVapourPressure)
            </SaturatedVapourPressure>
            <ReferenceTemperatureForSaturatedVapourPressure type="float" unit="°C" scales="global">
                $(Temp0)
            </ReferenceTemperatureForSaturatedVapourPressure>
            <MolarEnthalpyOfVaporization type="float" unit="kJ/mol" scales="global">
                $(MolarEnthalpyOfVaporization)
            </MolarEnthalpyOfVaporization>
            <SolubilityInWater type="float" unit="mg/l" scales="global">$(SolubilityInWater)</SolubilityInWater>
            <ReferenceTemperatureForWaterSolubility type="float" unit="°C" scales="global">
                $(Temp0)
            </ReferenceTemperatureForWaterSolubility>
            <MolarEnthalpyOfDissolution type="float" unit="kJ/mol" scales="global">
                $(MolarEnthalpyOfDissolution)
            </MolarEnthalpyOfDissolution>
            <DiffusionCoefficient type="float" unit="m²/d" scales="global">
                $(DiffusionCoefficient)
            </DiffusionCoefficient>
            <ReferenceTemperatureForDiffusion type="float" unit="°C" scales="global">
                $(Temp0)
            </ReferenceTemperatureForDiffusion>
            <HalfLifeTransformationInWater type="float" unit="d" scales="global">
                $(DT50sw)
            </HalfLifeTransformationInWater>
            <TemperatureAtWhichHalfLifeInWaterWasMeasured type="float" unit="°C" scales="global">
                $(Temp0)
            </TemperatureAtWhichHalfLifeInWaterWasMeasured>
            <MolarActivationEnthalpyOfTransformationInWater type="float" unit="kJ/mol" scales="global">
                $(MolarActivationEnthalpyOfTransformationInWater)
            </MolarActivationEnthalpyOfTransformationInWater>
            <HalfLifeTransformationInSediment type="float" unit="d" scales="global">
                $(DT50sed)
            </HalfLifeTransformationInSediment>
            <TemperatureAtWhichHalfLifeInSedimentWasMeasured type="float" unit="°C" scales="global">
                $(Temp0)
            </TemperatureAtWhichHalfLifeInSedimentWasMeasured>
            <MolarActivationEnthalpyOfTransformationInSediment type="float" unit="kJ/mol" scales="global">
                $(MolarActivationEnthalpyOfTransformationInSediment)
            </MolarActivationEnthalpyOfTransformationInSediment>
            <CoefficientForEquilibriumAdsorptionInSediment type="float" unit="l/kg" eval="true" scales="global">
                $(KOC) / 1.742
            </CoefficientForEquilibriumAdsorptionInSediment>
            <ReferenceConcentrationInLiquidPhaseInSediment type="float" unit="mg/l" scales="global">
                $(ReferenceConcentrationForKOC)
            </ReferenceConcentrationInLiquidPhaseInSediment>
            <FreundlichExponentInSediment type="float" unit="1" scales="global">
                $(FreundlichExponentInSedimentAndSuspendedParticles)
            </FreundlichExponentInSediment>
            <CoefficientForEquilibriumAdsorptionOfSuspendedSoils type="float" unit="l/kg" eval="true" scales="global">
                $(KOC) / 1.742
            </CoefficientForEquilibriumAdsorptionOfSuspendedSoils>
            <ReferenceConcentrationForSuspendedSoils type="float" unit="mg/l" scales="global">
                $(ReferenceConcentrationForKOC)
            </ReferenceConcentrationForSuspendedSoils>
            <FreundlichExponentForSuspendedSoils type="float" unit="1" scales="global">
                $(FreundlichExponentInSedimentAndSuspendedParticles)
            </FreundlichExponentForSuspendedSoils>
            <CoefficientForLinearAdsorptionOnMacrophytes type="float" unit="l/kg" scales="global">
                0
            </CoefficientForLinearAdsorptionOnMacrophytes>
            <NumberWorkers type="int" scales="global">$(CascadeToxswaWorkers)</NumberWorkers>
            <HydrographyGeometries>
                <FromOutput component="LandscapeScenario" output="hydrography_geom"/>
            </HydrographyGeometries>
            <DownstreamReach>
                <FromOutput component="LandscapeScenario" output="hydrography_downstream"/>
            </DownstreamReach>
            <BottomWidth>
                <FromOutput component="LandscapeScenario" output="hydrography_bottom_width"/>
            </BottomWidth>
            <BankSlope>
                <FromOutput component="LandscapeScenario" output="hydrography_bank_slope"/>
            </BankSlope>
            <OrganicContent>
                <FromOutput component="LandscapeScenario" output="hydrography_organic_content"/>
            </OrganicContent>
            <BulkDensity>
                <FromOutput component="LandscapeScenario" output="hydrography_bulk_density"/>
            </BulkDensity>
            <Porosity>
                <FromOutput component="LandscapeScenario" output="hydrography_porosity"/>
            </Porosity>
        </CascadeToxswa> 
    </Composition>
</MCRun>